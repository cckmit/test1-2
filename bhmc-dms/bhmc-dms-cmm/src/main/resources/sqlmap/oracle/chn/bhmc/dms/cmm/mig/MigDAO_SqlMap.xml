<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<!--
    SQL File Name : MigDAO_SqlMap.xml
    Description : 마이그레이션 관련 처리
    author Kang Seok Han
    since 2016. 12. 07.
    version 1.0
    Modification Information
       since          author              description
    ===========    =============    ===========================
    2016. 12. 07.     Kang Seok Han     최초 생성
-->

<mapper namespace="chn.bhmc.dms.cmm.mig.service.dao.MigDAO">

    <!--
                딜러정보 업데이트
        DCS 딜러정보를 DB링크를 통하여 DMS 딜러정보를 등록/수정 하고 딜러마스터 정보의 SYS_OWNER_YN, USE_CENTER_DMS_YN 값을 변경한다.
    -->
    <insert id="insertOrUpdateDealer" parameterType="map">
        MERGE INTO CM_0101T T1
            USING (
                SELECT
                    CMP_CD                  --회사코드
                    ,CORP_CD                --법인코드
                    ,DLR_CD                 --딜러코드
                    ,DLR_NM                 --딜러명
                    ,DLR_SHT_NM             --딜러축소명
                    ,MAIN_DLR_YN            --메인딜러여부
                    ,SDPT_CD                --사업부코드
                    ,SER_DLR_YN             --정비딜러여부
                    ,SAL_DLR_YN             --판매딜러여부
                    ,PAR_DLR_YN             --부품딜러여부
                    ,DIST_OFFICE_CD         --지역사무소코드
                    ,SPR_DLR_CD             --SPR딜러코드
                    ,OWN_RGST_NM            --대표자명
                    ,SER_RGST_NM            --정비사장명
                    ,TEL_NO                 --전화번호
                    ,TEL_NO1                --전화번호1
                    ,TEL_NO2                --전화번호2
                    ,HP_NO                  --휴대폰번호
                    ,EMAIL_NM               --이메일명
                    ,FAX_NO                 --팩스번호
                    ,CALL_CEN_TEL_NO        --콜센터전화번호
                    ,EMGC_CEN_TEL_NO        --구급센터전화번호
                    ,SAL_DLR_TEL_NO         --판매딜러전화번호
                    ,SER_DLR_TEL_NO         --정비딜러전화번호
                    ,SER_DLR_HP_NO          --정비딜러휴대폰번호
                    ,SER_DLR_FAX_NO         --정비딜러팩스번호
                    ,SER_DLR_EMAIL_NM       --정비딜러이메일명
                    ,SER_DLR_TP             --정비딜러유형
                    ,SER_DLR_DIST_CD        --정비딜러지역코드
                    ,SER_DLR_AREA_CD        --정비딜러광역코드
                    ,SER_DLR_SUNG_CD        --정비딜러성코드
                    ,SER_DLR_COMM_NM        --정비딜러연락인명
                    ,SER_DLR_COMM_TEL_NO    --정비딜러연락인전화번호
                    ,SER_DLR_ZIP_NO         --정비딜러우편번호
                    ,SER_DLR_ADDR1_NM       --정비딜러주소1명
                    ,SER_DLR_ADDR2_NM       --정비딜러주소2명
                    ,SER_DLR_ADDR3_NM       --정비딜러주소3명
                    ,SER_DLR_CITY_NM        --정비딜러도시명
                    ,PAR_DLR_CD             --부품딜러코드
                    ,PAR_MAIN_DLR_CD        --부품메인딜러코드
                    ,PAR_MNG_DLR_NM         --부품관리딜러명
                    ,PAR_DLR_TEL_NO         --부품딜러전화번호
                    ,PAR_DLR_HP_NO          --부품딜러휴대폰번호
                    ,PAR_DLR_FAX_NO         --부품딜러팩스번호
                    ,PAR_DLR_EMAIL_NM       --부품딜러이메일명
                    ,PAR_DLR_SCALE_VAL      --부품딜러범위값
                    ,PAR_DLR_DC_RATE        --부품딜러할인율
                    ,PAR_DLR_VIP_DC_RATE    --부품딜러VIP할인율
                    ,PAR_DLR_WS_DC_RATE     --부품딜러W/S할인율
                    ,PAR_DLR_EMR_DC_RATE    --부품딜러EMR할인율
                    ,PAR_DLR_DC_FILTER_RATE --부품딜러할인필터율
                    ,PAR_DLR_STRGE_CNT      --부품딜러창고수
                    ,PAR_DLR_PO_DT          --부품딜러PO일자
                    ,PAR_DLR_START_DT       --부품딜러시작일자
                    ,PAR_DLR_END_DT         --부품딜러종료일자
                    ,PAR_DLR_ZIP_NO         --부품딜러우편번호
                    ,PAR_DLR_ADDR1_NM       --부품딜러주소1명
                    ,PAR_DLR_ADDR2_NM       --부품딜러주소2명
                    ,PAR_DLR_ADDR3_NM       --부품딜러주소3명
                    ,DEL_YN                 --삭제여부
                    ,PAR_EXPR_DT            --부품만기일자
                    ,PAR_PDC_CD             --부품PDC코드
                    ,DIST_CD                --지역코드
                    ,DLR_GRP_CD             --딜러그룹코드
                    ,ZIP_NO                 --우편번호
                    ,ADDR1_NM               --주소1명
                    ,ADDR2_NM               --주소2명
                    ,DETL_ADDR_NM           --상세주소명
                    ,PRID_START_DT          --기간시작일자
                    ,PRID_END_DT            --기간종료일자
                    ,SER_START_DT           --정비시작일자
                    ,SER_END_DT             --정비종료일자
                    ,HOMEPAGE_NM            --홈페이지명
                    ,REG_USR_ID             --등록자ID
                    ,REG_DT                 --등록일자
                    ,OP_USR_ID              --조작자ID
                    ,UPDT_USR_ID            --수정자ID
                    ,UPDT_DT                --수정일자
                    ,DLR_STAT_CD            --딜러상태코드
                    ,SALE_DLR_DIST_CD       --판매딜러지역코드
                    ,SALE_DLR_CITY_CD       --판매딜러도시코드
                    ,SALE_DLR_SUNG_CD       --판매딜러성코드
                    ,BANK_NM                --은행명
                    ,BANK_AC_NO             --은행계좌번호
                    ,STOCK_LOC_CD           --재고위치코드
                    ,PAY_TERM_CD            --지불조건코드
                    ,LEAD_TIME_CD           --LEAD시간코드
                    ,LTTU_VAL               --위도값
                    ,LOTU_VAL               --경도값
                    ,DMS_IP_NM              --DMSIP명
                    ,DMS_PORT_NM            --DMSPORT명
                    ,DMS_TEST_URL_NM        --DMS테스트URL명
                    ,DMS_OPER_EMAIL_NM      --DMS운영자이메일명
                    ,DMS_OPER_TEL_NO        --DMS운영자전화번호
                    ,DMS_USE_YN             --DMS사용여부
                FROM CM_0101T@BHDMSOP
            ) T2 ON (
                T1.DLR_CD = T2.DLR_CD
            )
            WHEN MATCHED THEN
                UPDATE SET
                    T1.CMP_CD                 = T2.CMP_CD                 --회사코드
                    ,T1.CORP_CD               = T2.CORP_CD                --법인코드
                    ,T1.DLR_NM                = T2.DLR_NM                 --딜러명
                    ,T1.DLR_SHT_NM            = T2.DLR_SHT_NM             --딜러축소명
                    ,T1.MAIN_DLR_YN           = T2.MAIN_DLR_YN            --메인딜러여부
                    ,T1.SDPT_CD               = T2.SDPT_CD                --사업부코드
                    ,T1.SER_DLR_YN            = T2.SER_DLR_YN             --정비딜러여부
                    ,T1.SAL_DLR_YN            = T2.SAL_DLR_YN             --판매딜러여부
                    ,T1.PAR_DLR_YN            = T2.PAR_DLR_YN             --부품딜러여부
                    ,T1.DIST_OFFICE_CD        = T2.DIST_OFFICE_CD         --지역사무소코드
                    ,T1.SPR_DLR_CD            = T2.SPR_DLR_CD             --SPR딜러코드
                    ,T1.OWN_RGST_NM           = T2.OWN_RGST_NM            --대표자명
                    ,T1.SER_RGST_NM           = T2.SER_RGST_NM            --정비사장명
                    ,T1.TEL_NO                = T2.TEL_NO                 --전화번호
                    ,T1.TEL_NO1               = T2.TEL_NO1                --전화번호1
                    ,T1.TEL_NO2               = T2.TEL_NO2                --전화번호2
                    ,T1.HP_NO                 = T2.HP_NO                  --휴대폰번호
                    ,T1.EMAIL_NM              = T2.EMAIL_NM               --이메일명
                    ,T1.FAX_NO                = T2.FAX_NO                 --팩스번호
                    ,T1.CALL_CEN_TEL_NO       = T2.CALL_CEN_TEL_NO        --콜센터전화번호
                    ,T1.EMGC_CEN_TEL_NO       = T2.EMGC_CEN_TEL_NO        --구급센터전화번호
                    ,T1.SAL_DLR_TEL_NO        = T2.SAL_DLR_TEL_NO         --판매딜러전화번호
                    ,T1.SER_DLR_TEL_NO        = T2.SER_DLR_TEL_NO         --정비딜러전화번호
                    ,T1.SER_DLR_HP_NO         = T2.SER_DLR_HP_NO          --정비딜러휴대폰번호
                    ,T1.SER_DLR_FAX_NO        = T2.SER_DLR_FAX_NO         --정비딜러팩스번호
                    ,T1.SER_DLR_EMAIL_NM      = T2.SER_DLR_EMAIL_NM       --정비딜러이메일명
                    ,T1.SER_DLR_TP            = T2.SER_DLR_TP             --정비딜러유형
                    ,T1.SER_DLR_DIST_CD       = T2.SER_DLR_DIST_CD        --정비딜러지역코드
                    ,T1.SER_DLR_AREA_CD       = T2.SER_DLR_AREA_CD        --정비딜러광역코드
                    ,T1.SER_DLR_SUNG_CD       = T2.SER_DLR_SUNG_CD        --정비딜러성코드
                    ,T1.SER_DLR_COMM_NM       = T2.SER_DLR_COMM_NM        --정비딜러연락인명
                    ,T1.SER_DLR_COMM_TEL_NO   = T2.SER_DLR_COMM_TEL_NO    --정비딜러연락인전화번호
                    ,T1.SER_DLR_ZIP_NO        = T2.SER_DLR_ZIP_NO         --정비딜러우편번호
                    ,T1.SER_DLR_ADDR1_NM      = T2.SER_DLR_ADDR1_NM       --정비딜러주소1명
                    ,T1.SER_DLR_ADDR2_NM      = T2.SER_DLR_ADDR2_NM       --정비딜러주소2명
                    ,T1.SER_DLR_ADDR3_NM      = T2.SER_DLR_ADDR3_NM       --정비딜러주소3명
                    ,T1.SER_DLR_CITY_NM       = T2.SER_DLR_CITY_NM        --정비딜러도시명
                    ,T1.PAR_DLR_CD            = T2.PAR_DLR_CD             --부품딜러코드
                    ,T1.PAR_MAIN_DLR_CD       = T2.PAR_MAIN_DLR_CD        --부품메인딜러코드
                    ,T1.PAR_MNG_DLR_NM        = T2.PAR_MNG_DLR_NM         --부품관리딜러명
                    ,T1.PAR_DLR_TEL_NO        = T2.PAR_DLR_TEL_NO         --부품딜러전화번호
                    ,T1.PAR_DLR_HP_NO         = T2.PAR_DLR_HP_NO          --부품딜러휴대폰번호
                    ,T1.PAR_DLR_FAX_NO        = T2.PAR_DLR_FAX_NO         --부품딜러팩스번호
                    ,T1.PAR_DLR_EMAIL_NM      = T2.PAR_DLR_EMAIL_NM       --부품딜러이메일명
                    ,T1.PAR_DLR_SCALE_VAL     = T2.PAR_DLR_SCALE_VAL      --부품딜러범위값
                    ,T1.PAR_DLR_DC_RATE       = T2.PAR_DLR_DC_RATE        --부품딜러할인율
                    ,T1.PAR_DLR_VIP_DC_RATE   = T2.PAR_DLR_VIP_DC_RATE    --부품딜러VIP할인율
                    ,T1.PAR_DLR_WS_DC_RATE    = T2.PAR_DLR_WS_DC_RATE     --부품딜러W/S할인율
                    ,T1.PAR_DLR_EMR_DC_RATE   = T2.PAR_DLR_EMR_DC_RATE    --부품딜러EMR할인율
                    ,T1.PAR_DLR_DC_FILTER_RATE= T2.PAR_DLR_DC_FILTER_RATE --부품딜러할인필터율
                    ,T1.PAR_DLR_STRGE_CNT     = T2.PAR_DLR_STRGE_CNT      --부품딜러창고수
                    ,T1.PAR_DLR_PO_DT         = T2.PAR_DLR_PO_DT          --부품딜러PO일자
                    ,T1.PAR_DLR_START_DT      = T2.PAR_DLR_START_DT       --부품딜러시작일자
                    ,T1.PAR_DLR_END_DT        = T2.PAR_DLR_END_DT         --부품딜러종료일자
                    ,T1.PAR_DLR_ZIP_NO        = T2.PAR_DLR_ZIP_NO         --부품딜러우편번호
                    ,T1.PAR_DLR_ADDR1_NM      = T2.PAR_DLR_ADDR1_NM       --부품딜러주소1명
                    ,T1.PAR_DLR_ADDR2_NM      = T2.PAR_DLR_ADDR2_NM       --부품딜러주소2명
                    ,T1.PAR_DLR_ADDR3_NM      = T2.PAR_DLR_ADDR3_NM       --부품딜러주소3명
                    ,T1.DEL_YN                = T2.DEL_YN                 --삭제여부
                    ,T1.PAR_EXPR_DT           = T2.PAR_EXPR_DT            --부품만기일자
                    ,T1.PAR_PDC_CD            = T2.PAR_PDC_CD             --부품PDC코드
                    ,T1.DIST_CD               = T2.DIST_CD                --지역코드
                    ,T1.DLR_GRP_CD            = T2.DLR_GRP_CD             --딜러그룹코드
                    ,T1.ZIP_NO                = T2.ZIP_NO                 --우편번호
                    ,T1.ADDR1_NM              = T2.ADDR1_NM               --주소1명
                    ,T1.ADDR2_NM              = T2.ADDR2_NM               --주소2명
                    ,T1.DETL_ADDR_NM          = T2.DETL_ADDR_NM           --상세주소명
                    ,T1.PRID_START_DT         = T2.PRID_START_DT          --기간시작일자
                    ,T1.PRID_END_DT           = T2.PRID_END_DT            --기간종료일자
                    ,T1.SER_START_DT          = T2.SER_START_DT           --정비시작일자
                    ,T1.SER_END_DT            = T2.SER_END_DT             --정비종료일자
                    ,T1.HOMEPAGE_NM           = T2.HOMEPAGE_NM            --홈페이지명
                    ,T1.REG_USR_ID            = T2.REG_USR_ID             --등록자ID
                    ,T1.REG_DT                = T2.REG_DT                 --등록일자
                    ,T1.OP_USR_ID             = T2.OP_USR_ID              --조작자ID
                    ,T1.UPDT_USR_ID           = T2.UPDT_USR_ID            --수정자ID
                    ,T1.UPDT_DT               = T2.UPDT_DT                --수정일자
                    ,T1.DLR_STAT_CD           = T2.DLR_STAT_CD            --딜러상태코드
                    ,T1.SALE_DLR_DIST_CD      = T2.SALE_DLR_DIST_CD       --판매딜러지역코드
                    ,T1.SALE_DLR_CITY_CD      = T2.SALE_DLR_CITY_CD       --판매딜러도시코드
                    ,T1.SALE_DLR_SUNG_CD      = T2.SALE_DLR_SUNG_CD       --판매딜러성코드
                    ,T1.BANK_NM               = T2.BANK_NM                --은행명
                    ,T1.BANK_AC_NO            = T2.BANK_AC_NO             --은행계좌번호
                    ,T1.STOCK_LOC_CD          = T2.STOCK_LOC_CD           --재고위치코드
                    ,T1.PAY_TERM_CD           = T2.PAY_TERM_CD            --지불조건코드
                    ,T1.LEAD_TIME_CD          = T2.LEAD_TIME_CD           --LEAD시간코드
                    ,T1.LTTU_VAL              = T2.LTTU_VAL               --위도값
                    ,T1.LOTU_VAL              = T2.LOTU_VAL               --경도값
                    ,T1.DMS_IP_NM             = T2.DMS_IP_NM              --DMSIP명
                    ,T1.DMS_PORT_NM           = T2.DMS_PORT_NM            --DMSPORT명
                    ,T1.DMS_TEST_URL_NM       = T2.DMS_TEST_URL_NM        --DMS테스트URL명
                    ,T1.DMS_OPER_EMAIL_NM     = T2.DMS_OPER_EMAIL_NM      --DMS운영자이메일명
                    ,T1.DMS_OPER_TEL_NO       = T2.DMS_OPER_TEL_NO        --DMS운영자전화번호
                    ,T1.DMS_USE_YN            = T2.DMS_USE_YN             --DMS사용여부
            WHEN NOT MATCHED THEN
                INSERT(
                     T1.CMP_CD
                    ,T1.CORP_CD
                    ,T1.DLR_CD
                    ,T1.DLR_NM
                    ,T1.DLR_SHT_NM
                    ,T1.MAIN_DLR_YN
                    ,T1.SDPT_CD
                    ,T1.SER_DLR_YN
                    ,T1.SAL_DLR_YN
                    ,T1.PAR_DLR_YN
                    ,T1.DIST_OFFICE_CD
                    ,T1.SPR_DLR_CD
                    ,T1.OWN_RGST_NM
                    ,T1.SER_RGST_NM
                    ,T1.TEL_NO
                    ,T1.TEL_NO1
                    ,T1.TEL_NO2
                    ,T1.HP_NO
                    ,T1.EMAIL_NM
                    ,T1.FAX_NO
                    ,T1.CALL_CEN_TEL_NO
                    ,T1.EMGC_CEN_TEL_NO
                    ,T1.SAL_DLR_TEL_NO
                    ,T1.SER_DLR_TEL_NO
                    ,T1.SER_DLR_HP_NO
                    ,T1.SER_DLR_FAX_NO
                    ,T1.SER_DLR_EMAIL_NM
                    ,T1.SER_DLR_TP
                    ,T1.SER_DLR_DIST_CD
                    ,T1.SER_DLR_AREA_CD
                    ,T1.SER_DLR_SUNG_CD
                    ,T1.SER_DLR_COMM_NM
                    ,T1.SER_DLR_COMM_TEL_NO
                    ,T1.SER_DLR_ZIP_NO
                    ,T1.SER_DLR_ADDR1_NM
                    ,T1.SER_DLR_ADDR2_NM
                    ,T1.SER_DLR_ADDR3_NM
                    ,T1.SER_DLR_CITY_NM
                    ,T1.PAR_DLR_CD
                    ,T1.PAR_MAIN_DLR_CD
                    ,T1.PAR_MNG_DLR_NM
                    ,T1.PAR_DLR_TEL_NO
                    ,T1.PAR_DLR_HP_NO
                    ,T1.PAR_DLR_FAX_NO
                    ,T1.PAR_DLR_EMAIL_NM
                    ,T1.PAR_DLR_SCALE_VAL
                    ,T1.PAR_DLR_DC_RATE
                    ,T1.PAR_DLR_VIP_DC_RATE
                    ,T1.PAR_DLR_WS_DC_RATE
                    ,T1.PAR_DLR_EMR_DC_RATE
                    ,T1.PAR_DLR_DC_FILTER_RATE
                    ,T1.PAR_DLR_STRGE_CNT
                    ,T1.PAR_DLR_PO_DT
                    ,T1.PAR_DLR_START_DT
                    ,T1.PAR_DLR_END_DT
                    ,T1.PAR_DLR_ZIP_NO
                    ,T1.PAR_DLR_ADDR1_NM
                    ,T1.PAR_DLR_ADDR2_NM
                    ,T1.PAR_DLR_ADDR3_NM
                    ,T1.DEL_YN
                    ,T1.PAR_EXPR_DT
                    ,T1.PAR_PDC_CD
                    ,T1.DIST_CD
                    ,T1.DLR_GRP_CD
                    ,T1.ZIP_NO
                    ,T1.ADDR1_NM
                    ,T1.ADDR2_NM
                    ,T1.DETL_ADDR_NM
                    ,T1.PRID_START_DT
                    ,T1.PRID_END_DT
                    ,T1.SER_START_DT
                    ,T1.SER_END_DT
                    ,T1.HOMEPAGE_NM
                    ,T1.REG_USR_ID
                    ,T1.REG_DT
                    ,T1.OP_USR_ID
                    ,T1.UPDT_USR_ID
                    ,T1.UPDT_DT
                    ,T1.DLR_STAT_CD
                    ,T1.SALE_DLR_DIST_CD
                    ,T1.SALE_DLR_CITY_CD
                    ,T1.SALE_DLR_SUNG_CD
                    ,T1.BANK_NM
                    ,T1.BANK_AC_NO
                    ,T1.STOCK_LOC_CD
                    ,T1.PAY_TERM_CD
                    ,T1.LEAD_TIME_CD
                    ,T1.LTTU_VAL
                    ,T1.LOTU_VAL
                    ,T1.DMS_IP_NM
                    ,T1.DMS_PORT_NM
                    ,T1.DMS_TEST_URL_NM
                    ,T1.DMS_OPER_EMAIL_NM
                    ,T1.DMS_OPER_TEL_NO
                    ,T1.DMS_USE_YN
                )VALUES(
                    T2.CMP_CD
                    ,T2.CORP_CD
                    ,T2.DLR_CD
                    ,T2.DLR_NM
                    ,T2.DLR_SHT_NM
                    ,T2.MAIN_DLR_YN
                    ,T2.SDPT_CD
                    ,T2.SER_DLR_YN
                    ,T2.SAL_DLR_YN
                    ,T2.PAR_DLR_YN
                    ,T2.DIST_OFFICE_CD
                    ,T2.SPR_DLR_CD
                    ,T2.OWN_RGST_NM
                    ,T2.SER_RGST_NM
                    ,T2.TEL_NO
                    ,T2.TEL_NO1
                    ,T2.TEL_NO2
                    ,T2.HP_NO
                    ,T2.EMAIL_NM
                    ,T2.FAX_NO
                    ,T2.CALL_CEN_TEL_NO
                    ,T2.EMGC_CEN_TEL_NO
                    ,T2.SAL_DLR_TEL_NO
                    ,T2.SER_DLR_TEL_NO
                    ,T2.SER_DLR_HP_NO
                    ,T2.SER_DLR_FAX_NO
                    ,T2.SER_DLR_EMAIL_NM
                    ,T2.SER_DLR_TP
                    ,T2.SER_DLR_DIST_CD
                    ,T2.SER_DLR_AREA_CD
                    ,T2.SER_DLR_SUNG_CD
                    ,T2.SER_DLR_COMM_NM
                    ,T2.SER_DLR_COMM_TEL_NO
                    ,T2.SER_DLR_ZIP_NO
                    ,T2.SER_DLR_ADDR1_NM
                    ,T2.SER_DLR_ADDR2_NM
                    ,T2.SER_DLR_ADDR3_NM
                    ,T2.SER_DLR_CITY_NM
                    ,T2.PAR_DLR_CD
                    ,T2.PAR_MAIN_DLR_CD
                    ,T2.PAR_MNG_DLR_NM
                    ,T2.PAR_DLR_TEL_NO
                    ,T2.PAR_DLR_HP_NO
                    ,T2.PAR_DLR_FAX_NO
                    ,T2.PAR_DLR_EMAIL_NM
                    ,T2.PAR_DLR_SCALE_VAL
                    ,T2.PAR_DLR_DC_RATE
                    ,T2.PAR_DLR_VIP_DC_RATE
                    ,T2.PAR_DLR_WS_DC_RATE
                    ,T2.PAR_DLR_EMR_DC_RATE
                    ,T2.PAR_DLR_DC_FILTER_RATE
                    ,T2.PAR_DLR_STRGE_CNT
                    ,T2.PAR_DLR_PO_DT
                    ,T2.PAR_DLR_START_DT
                    ,T2.PAR_DLR_END_DT
                    ,T2.PAR_DLR_ZIP_NO
                    ,T2.PAR_DLR_ADDR1_NM
                    ,T2.PAR_DLR_ADDR2_NM
                    ,T2.PAR_DLR_ADDR3_NM
                    ,T2.DEL_YN
                    ,T2.PAR_EXPR_DT
                    ,T2.PAR_PDC_CD
                    ,T2.DIST_CD
                    ,T2.DLR_GRP_CD
                    ,T2.ZIP_NO
                    ,T2.ADDR1_NM
                    ,T2.ADDR2_NM
                    ,T2.DETL_ADDR_NM
                    ,T2.PRID_START_DT
                    ,T2.PRID_END_DT
                    ,T2.SER_START_DT
                    ,T2.SER_END_DT
                    ,T2.HOMEPAGE_NM
                    ,T2.REG_USR_ID
                    ,T2.REG_DT
                    ,T2.OP_USR_ID
                    ,T2.UPDT_USR_ID
                    ,T2.UPDT_DT
                    ,T2.DLR_STAT_CD
                    ,T2.SALE_DLR_DIST_CD
                    ,T2.SALE_DLR_CITY_CD
                    ,T2.SALE_DLR_SUNG_CD
                    ,T2.BANK_NM
                    ,T2.BANK_AC_NO
                    ,T2.STOCK_LOC_CD
                    ,T2.PAY_TERM_CD
                    ,T2.LEAD_TIME_CD
                    ,T2.LTTU_VAL
                    ,T2.LOTU_VAL
                    ,T2.DMS_IP_NM
                    ,T2.DMS_PORT_NM
                    ,T2.DMS_TEST_URL_NM
                    ,T2.DMS_OPER_EMAIL_NM
                    ,T2.DMS_OPER_TEL_NO
                    ,T2.DMS_USE_YN
                );

            UPDATE CM_0101T SET SYS_OWNER_YN = 'N';

            <choose>
                <when test='useCenterDmsYn == "Y"'>
                    UPDATE CM_0101T SET USE_CENTER_DMS_YN = 'Y' WHERE DLR_CD = #{dlrCd};
                </when>
                <otherwise>
                    UPDATE CM_0101T SET SYS_OWNER_YN = 'Y' WHERE DLR_CD = #{dlrCd};
                </otherwise>
            </choose>
    </insert>

    <!--
            창고정보를 등록한다.
    -->
    <insert id="insertOrUpdateStorage" parameterType="string">
        INSERT INTO CM_0104T(
            STRGE_CD
            ,PLT_CD
            ,DLR_CD
            ,STRGE_NM
            ,NETING_USE_YN
            ,LOC_MNG_YN
            ,REG_USR_ID
            ,REG_DT
            ,UPDT_USR_ID
            ,UPDT_DT
            ,STRGE_TP
            ,STRGE_CRE_DT
            ,STRGE_REG_PRSN_NM
        ) VALUES (
            'WHC1'
            ,'1000'
            ,#{value}
            ,'Warehouse VIN'
            ,'N'
            ,'Y'
            ,'SYSTEM'
            ,SYSDATE
            ,'SYSTEM'
            ,SYSDATE
            ,'02'
            ,SYSDATE
            ,'SYSTEM'
        );

        INSERT INTO CM_0104T(
            STRGE_CD
            ,PLT_CD
            ,DLR_CD
            ,STRGE_NM
            ,NETING_USE_YN
            ,LOC_MNG_YN
            ,REG_USR_ID
            ,REG_DT
            ,UPDT_USR_ID
            ,UPDT_DT
            ,STRGE_TP
            ,STRGE_CRE_DT
            ,STRGE_REG_PRSN_NM
        ) VALUES (
            'WHP1'
            ,'1000'
            ,#{value}
            ,'Warehouse Parts'
            ,'N'
            ,'Y'
            ,'SYSTEM'
            ,SYSDATE
            ,'SYSTEM'
            ,SYSDATE
            ,'02'
            ,SYSDATE
            ,'SYSTEM'
        );
    </insert>

    <!--
                시스템설정 정보 업데이트
        DCS 시스템설정 정보를 DB링크를 통하여 DMS 시스템설정 정보를 등록/수정한다.
    -->
    <insert id="insertOrUpdateSystemInfo">
        MERGE INTO CM_0201T T1
        USING (
            SELECT
                PREF_KEY
                ,PREF_VAL
                ,PREF_NM
                ,MULTI_YN
                ,UPDT_USR_ID
                ,UPDT_DT
            FROM CM_0201T@BHDMSOP
        ) T2 ON (
            T1.PREF_KEY = T2.PREF_KEY
        )
        WHEN MATCHED THEN
            UPDATE SET
                T1.PREF_VAL    = T2.PREF_VAL
                ,T1.PREF_NM     = T2.PREF_NM
                ,T1.MULTI_YN    = T2.MULTI_YN
                ,T1.UPDT_USR_ID = T2.UPDT_USR_ID
                ,T1.UPDT_DT     = T2.UPDT_DT
        WHEN NOT MATCHED THEN
            INSERT(
                 T1.PREF_KEY
                ,T1.PREF_VAL
                ,T1.PREF_NM
                ,T1.MULTI_YN
                ,T1.UPDT_USR_ID
                ,T1.UPDT_DT
            )VALUES(
                 T2.PREF_KEY
                ,T2.PREF_VAL
                ,T2.PREF_NM
                ,T2.MULTI_YN
                ,T2.UPDT_USR_ID
                ,T2.UPDT_DT
            );
    </insert>

    <!--
                국가정보 업데이트
        DCS 국가정보를 DB링크를 통하여 DMS 국가정보를 등록/수정한다.
    -->
    <insert id="insertOrUpdateCountry">
        MERGE INTO CM_0202T T1
        USING (
            SELECT
                 CNTRY_CD
                ,LANG_CD
                ,CNTRY_NM
                ,REG_USR_ID
                ,REG_DT
                ,UPDT_USR_ID
                ,UPDT_DT
            FROM CM_0202T@BHDMSOP
        ) T2 ON (
            T1.CNTRY_CD = T2.CNTRY_CD
            AND T1.LANG_CD = T2.LANG_CD
        )
        WHEN MATCHED THEN
            UPDATE SET
                T1.CNTRY_NM   = T2.CNTRY_NM
                ,T1.REG_USR_ID = T2.REG_USR_ID
                ,T1.REG_DT     = T2.REG_DT
                ,T1.UPDT_USR_ID= T2.UPDT_USR_ID
                ,T1.UPDT_DT    = T2.UPDT_DT
        WHEN NOT MATCHED THEN
            INSERT(
                 T1.CNTRY_CD
                ,T1.LANG_CD
                ,T1.CNTRY_NM
                ,T1.REG_USR_ID
                ,T1.REG_DT
                ,T1.UPDT_USR_ID
                ,T1.UPDT_DT
            )VALUES(
                 T2.CNTRY_CD
                ,T2.LANG_CD
                ,T2.CNTRY_NM
                ,T2.REG_USR_ID
                ,T2.REG_DT
                ,T2.UPDT_USR_ID
                ,T2.UPDT_DT
            );
    </insert>

    <!--
                언어정보 업데이트
        DCS 언어정보를 DB링크를 통하여 DMS 언어정보를 등록/수정한다.
    -->
    <insert id="insertOrUpdateLang">
        MERGE INTO CM_0203T T1
        USING (
            SELECT
                 LANG_CD
                ,LANG_NM
                ,ENABLED_YN
                ,REG_USR_ID
                ,REG_DT
                ,UPDT_USR_ID
                ,UPDT_DT
            FROM CM_0203T@BHDMSOP
        ) T2 ON (
            T1.LANG_CD = T2.LANG_CD
        )
        WHEN MATCHED THEN
            UPDATE SET
                 T1.LANG_NM     = T2.LANG_NM
                ,T1.ENABLED_YN  = T2.ENABLED_YN
                ,T1.REG_USR_ID  = T2.REG_USR_ID
                ,T1.REG_DT      = T2.REG_DT
                ,T1.UPDT_USR_ID = T2.UPDT_USR_ID
                ,T1.UPDT_DT     = T2.UPDT_DT
        WHEN NOT MATCHED THEN
            INSERT(
                 T1.LANG_CD
                ,T1.LANG_NM
                ,T1.ENABLED_YN
                ,T1.REG_USR_ID
                ,T1.REG_DT
                ,T1.UPDT_USR_ID
                ,T1.UPDT_DT
            )VALUES(
                 T2.LANG_CD
                ,T2.LANG_NM
                ,T2.ENABLED_YN
                ,T2.REG_USR_ID
                ,T2.REG_DT
                ,T2.UPDT_USR_ID
                ,T2.UPDT_DT
            );
    </insert>

    <!--
                통화코드정보 업데이트
        DCS 통화코드정보를 DB링크를 통하여 DMS 통화코드정보를 등록/수정한다.
    -->
    <insert id="insertOrUpdateCurrency">
        MERGE INTO CM_0204T T1
        USING (
            SELECT
                 CURRENCY_CD
                ,CURRENCY_SYM
                ,SYMBOL_POS_TP
                ,EXR_UNIT_AMT
                ,CURRENCY_NM
                ,FRACTION_CNT
                ,NUMBER_SYM
                ,DECIMAL_SYM
                ,EXR_TARG_YN
                ,REG_USR_ID
                ,REG_DT
                ,UPDT_USR_ID
                ,UPDT_DT
            FROM CM_0204T@BHDMSOP
        ) T2 ON (
            T1.CURRENCY_CD = T2.CURRENCY_CD
        )
        WHEN MATCHED THEN
            UPDATE SET
                 T1.CURRENCY_SYM  = T2.CURRENCY_SYM
                ,T1.SYMBOL_POS_TP = T2.SYMBOL_POS_TP
                ,T1.EXR_UNIT_AMT  = T2.EXR_UNIT_AMT
                ,T1.CURRENCY_NM   = T2.CURRENCY_NM
                ,T1.FRACTION_CNT  = T2.FRACTION_CNT
                ,T1.NUMBER_SYM    = T2.NUMBER_SYM
                ,T1.DECIMAL_SYM   = T2.DECIMAL_SYM
                ,T1.EXR_TARG_YN   = T2.EXR_TARG_YN
                ,T1.REG_USR_ID    = T2.REG_USR_ID
                ,T1.REG_DT        = T2.REG_DT
                ,T1.UPDT_USR_ID   = T2.UPDT_USR_ID
                ,T1.UPDT_DT       = T2.UPDT_DT
        WHEN NOT MATCHED THEN
            INSERT(
                 T1.CURRENCY_CD
                ,T1.CURRENCY_SYM
                ,T1.SYMBOL_POS_TP
                ,T1.EXR_UNIT_AMT
                ,T1.CURRENCY_NM
                ,T1.FRACTION_CNT
                ,T1.NUMBER_SYM
                ,T1.DECIMAL_SYM
                ,T1.EXR_TARG_YN
                ,T1.REG_USR_ID
                ,T1.REG_DT
                ,T1.UPDT_USR_ID
                ,T1.UPDT_DT
            )VALUES(
                 T2.CURRENCY_CD
                ,T2.CURRENCY_SYM
                ,T2.SYMBOL_POS_TP
                ,T2.EXR_UNIT_AMT
                ,T2.CURRENCY_NM
                ,T2.FRACTION_CNT
                ,T2.NUMBER_SYM
                ,T2.DECIMAL_SYM
                ,T2.EXR_TARG_YN
                ,T2.REG_USR_ID
                ,T2.REG_DT
                ,T2.UPDT_USR_ID
                ,T2.UPDT_DT
            );
    </insert>

    <!--
                우편번호정보 업데이트
        DCS 우편번호정보를 DB링크를 통하여 DMS 우편번호정보를 등록/수정한다.
    -->
    <insert id="insertOrUpdateZipCode">
        MERGE INTO CM_0205T T1
        USING (
            SELECT
                 SUNG_CD
                ,CITY_CD
                ,DIST_CD
                ,SUNG_NM
                ,CITY_NM
                ,DIST_NM
                ,ZIP_CD
                ,EXT_ZIP_CD
                ,USE_YN
                ,REG_USR_ID
                ,REG_DT
                ,UPDT_USR_ID
                ,UPDT_DT
            FROM CM_0205T@BHDMSOP
        ) T2 ON (
            T1.SUNG_CD = T2.SUNG_CD
            AND T1.CITY_CD = T2.CITY_CD
            AND T1.DIST_CD = T2.DIST_CD
        )
        WHEN MATCHED THEN
            UPDATE SET
                 T1.SUNG_NM     = T2.SUNG_NM
                ,T1.CITY_NM     = T2.CITY_NM
                ,T1.DIST_NM     = T2.DIST_NM
                ,T1.ZIP_CD      = T2.ZIP_CD
                ,T1.EXT_ZIP_CD  = T2.EXT_ZIP_CD
                ,T1.USE_YN      = T2.USE_YN
                ,T1.REG_USR_ID  = T2.REG_USR_ID
                ,T1.REG_DT      = T2.REG_DT
                ,T1.UPDT_USR_ID = T2.UPDT_USR_ID
                ,T1.UPDT_DT     = T2.UPDT_DT
        WHEN NOT MATCHED THEN
            INSERT(
                 T1.SUNG_CD
                ,T1.CITY_CD
                ,T1.DIST_CD
                ,T1.SUNG_NM
                ,T1.CITY_NM
                ,T1.DIST_NM
                ,T1.ZIP_CD
                ,T1.EXT_ZIP_CD
                ,T1.USE_YN
                ,T1.REG_USR_ID
                ,T1.REG_DT
                ,T1.UPDT_USR_ID
                ,T1.UPDT_DT
            )VALUES(
                 T2.SUNG_CD
                ,T2.CITY_CD
                ,T2.DIST_CD
                ,T2.SUNG_NM
                ,T2.CITY_NM
                ,T2.DIST_NM
                ,T2.ZIP_CD
                ,T2.EXT_ZIP_CD
                ,T2.USE_YN
                ,T2.REG_USR_ID
                ,T2.REG_DT
                ,T2.UPDT_USR_ID
                ,T2.UPDT_DT
            );
    </insert>

    <!--
                지역코드정보 업데이트
        DCS 지역코드정보를 DB링크를 통하여 DMS 지역코드정보를 등록/수정한다.
    -->
    <insert id="insertOrUpdateDistCode">
        MERGE INTO CM_0206T T1
        USING (
            SELECT
                 DIST_CD
                ,DIST_NM
                ,USE_YN
                ,REG_USR_ID
                ,REG_DT
                ,UPDT_USR_ID
                ,UPDT_DT
                ,SALE_DIST_YN
                ,SER_DIST_YN
                ,GOB_DIST_YN
            FROM CM_0206T@BHDMSOP
        ) T2 ON (
            T1.DIST_CD = T2.DIST_CD
        )
        WHEN MATCHED THEN
            UPDATE SET
                 T1.DIST_NM      = T2.DIST_NM
                ,T1.USE_YN       = T2.USE_YN
                ,T1.REG_USR_ID   = T2.REG_USR_ID
                ,T1.REG_DT       = T2.REG_DT
                ,T1.UPDT_USR_ID  = T2.UPDT_USR_ID
                ,T1.UPDT_DT      = T2.UPDT_DT
                ,T1.SALE_DIST_YN = T2.SALE_DIST_YN
                ,T1.SER_DIST_YN  = T2.SER_DIST_YN
                ,T1.GOB_DIST_YN  = T2.GOB_DIST_YN
        WHEN NOT MATCHED THEN
            INSERT(
                 T1.DIST_CD
                ,T1.DIST_NM
                ,T1.USE_YN
                ,T1.REG_USR_ID
                ,T1.REG_DT
                ,T1.UPDT_USR_ID
                ,T1.UPDT_DT
                ,T1.SALE_DIST_YN
                ,T1.SER_DIST_YN
                ,T1.GOB_DIST_YN
            )VALUES(
                 T2.DIST_CD
                ,T2.DIST_NM
                ,T2.USE_YN
                ,T2.REG_USR_ID
                ,T2.REG_DT
                ,T2.UPDT_USR_ID
                ,T2.UPDT_DT
                ,T2.SALE_DIST_YN
                ,T2.SER_DIST_YN
                ,T2.GOB_DIST_YN
            );
    </insert>

    <!--
                단위정보 업데이트
        DCS 단위정보를 DB링크를 통하여 DMS 단위정보를 등록/수정한다.
    -->
    <insert id="insertOrUpdateUnitInfo">
        MERGE INTO CM_0207T T1
        USING (
            SELECT
                 UNIT_SEQ
                ,UNIT_CD
                ,UNIT_EXT_CD
                ,UNIT_TP
                ,UNIT_NM
                ,UNIT_STD_YN
                ,NMRTR_VAL
                ,DENMNTR_VAL
                ,USE_YN
                ,REG_USR_ID
                ,REG_DT
                ,UPDT_USR_ID
                ,UPDT_DT
            FROM CM_0207T@BHDMSOP
        ) T2 ON (
            T1.UNIT_SEQ = T2.UNIT_SEQ
        )
        WHEN MATCHED THEN
            UPDATE SET
                 T1.UNIT_CD     = T2.UNIT_CD
                ,T1.UNIT_EXT_CD = T2.UNIT_EXT_CD
                ,T1.UNIT_TP     = T2.UNIT_TP
                ,T1.UNIT_NM     = T2.UNIT_NM
                ,T1.UNIT_STD_YN = T2.UNIT_STD_YN
                ,T1.NMRTR_VAL   = T2.NMRTR_VAL
                ,T1.DENMNTR_VAL = T2.DENMNTR_VAL
                ,T1.USE_YN      = T2.USE_YN
                ,T1.REG_USR_ID  = T2.REG_USR_ID
                ,T1.REG_DT      = T2.REG_DT
                ,T1.UPDT_USR_ID = T2.UPDT_USR_ID
                ,T1.UPDT_DT     = T2.UPDT_DT
        WHEN NOT MATCHED THEN
            INSERT(
                 T1.UNIT_SEQ
                ,T1.UNIT_CD
                ,T1.UNIT_EXT_CD
                ,T1.UNIT_TP
                ,T1.UNIT_NM
                ,T1.UNIT_STD_YN
                ,T1.NMRTR_VAL
                ,T1.DENMNTR_VAL
                ,T1.USE_YN
                ,T1.REG_USR_ID
                ,T1.REG_DT
                ,T1.UPDT_USR_ID
                ,T1.UPDT_DT
            )VALUES(
                 T2.UNIT_SEQ
                ,T2.UNIT_CD
                ,T2.UNIT_EXT_CD
                ,T2.UNIT_TP
                ,T2.UNIT_NM
                ,T2.UNIT_STD_YN
                ,T2.NMRTR_VAL
                ,T2.DENMNTR_VAL
                ,T2.USE_YN
                ,T2.REG_USR_ID
                ,T2.REG_DT
                ,T2.UPDT_USR_ID
                ,T2.UPDT_DT
            );
    </insert>

    <!--
                날짜데이터 업데이트
        DCS 날짜데이터 를 DB링크를 통하여 DMS 날짜데이터 를 등록/수정한다.
    -->
    <insert id="insertOrUpdateDateInfo">
        MERGE INTO CM_0212T T1
        USING (
            SELECT
                 DT
                ,YY
                ,Q
                ,MM
                ,DD
                ,DAYWEEK
                ,MM_NM
                ,DAYWEEK_NM
                ,WEEK
                ,WEEKDAY_YN
            FROM CM_0212T@BHDMSOP
        ) T2 ON (
            T1.DT = T2.DT
        )
        WHEN MATCHED THEN
            UPDATE SET
                 T1.YY         = T2.YY
                ,T1.Q          = T2.Q
                ,T1.MM         = T2.MM
                ,T1.DD         = T2.DD
                ,T1.DAYWEEK    = T2.DAYWEEK
                ,T1.MM_NM      = T2.MM_NM
                ,T1.DAYWEEK_NM = T2.DAYWEEK_NM
                ,T1.WEEK       = T2.WEEK
                ,T1.WEEKDAY_YN = T2.WEEKDAY_YN
        WHEN NOT MATCHED THEN
            INSERT(
                 T1.DT
                ,T1.YY
                ,T1.Q
                ,T1.MM
                ,T1.DD
                ,T1.DAYWEEK
                ,T1.MM_NM
                ,T1.DAYWEEK_NM
                ,T1.WEEK
                ,T1.WEEKDAY_YN
            )VALUES(
                 T2.DT
                ,T2.YY
                ,T2.Q
                ,T2.MM
                ,T2.DD
                ,T2.DAYWEEK
                ,T2.MM_NM
                ,T2.DAYWEEK_NM
                ,T2.WEEK
                ,T2.WEEKDAY_YN
            );
    </insert>

    <!--
                타임존 업데이트
        DCS 타임존 를 DB링크를 통하여 DMS 타임존 를 등록/수정한다.
    -->
    <insert id="insertOrUpdateTimeZone">
        MERGE INTO CM_0213T T1
        USING (
            SELECT
                 TIMEZONE_ID
                ,STD_TIME_OFFSET
                ,ALIASES_NM
                ,USE_YN
                ,REG_USR_ID
                ,REG_DT
                ,UPDT_USR_ID
                ,UPDT_DT
            FROM CM_0213T@BHDMSOP
        ) T2 ON (
            T1.TIMEZONE_ID = T2.TIMEZONE_ID
        )
        WHEN MATCHED THEN
            UPDATE SET
                 T1.STD_TIME_OFFSET = T2.STD_TIME_OFFSET
                ,T1.ALIASES_NM      = T2.ALIASES_NM
                ,T1.USE_YN          = T2.USE_YN
                ,T1.REG_USR_ID      = T2.REG_USR_ID
                ,T1.REG_DT          = T2.REG_DT
                ,T1.UPDT_USR_ID     = T2.UPDT_USR_ID
                ,T1.UPDT_DT         = T2.UPDT_DT
        WHEN NOT MATCHED THEN
            INSERT(
                 T1.TIMEZONE_ID
                ,T1.STD_TIME_OFFSET
                ,T1.ALIASES_NM
                ,T1.USE_YN
                ,T1.REG_USR_ID
                ,T1.REG_DT
                ,T1.UPDT_USR_ID
                ,T1.UPDT_DT
            )VALUES(
                 T2.TIMEZONE_ID
                ,T2.STD_TIME_OFFSET
                ,T2.ALIASES_NM
                ,T2.USE_YN
                ,T2.REG_USR_ID
                ,T2.REG_DT
                ,T2.UPDT_USR_ID
                ,T2.UPDT_DT
            );

        MERGE INTO CM_0214T T1
        USING (
            SELECT
                 TIMEZONE_ID
                ,LANG_CD
                ,TIMEZONE_TXT
                ,REG_USR_ID
                ,REG_DT
                ,UPDT_USR_ID
                ,UPDT_DT
            FROM CM_0214T@BHDMSOP
        ) T2 ON (
            T1.TIMEZONE_ID = T2.TIMEZONE_ID
            AND T1.LANG_CD = T2.LANG_CD
        )
        WHEN MATCHED THEN
            UPDATE SET
                 T1.TIM1EZONE_TXT = T2.TIMEZONE_TXT
                ,T1.REG_USR_ID   = T2.REG_USR_ID
                ,T1.REG_DT       = T2.REG_DT
                ,T1.UPDT_USR_ID  = T2.UPDT_USR_ID
                ,T1.UPDT_DT      = T2.UPDT_DT
        WHEN NOT MATCHED THEN
            INSERT(
                 T1.TIMEZONE_ID
                ,T1.LANG_CD
                ,T1.TIMEZONE_TXT
                ,T1.REG_USR_ID
                ,T1.REG_DT
                ,T1.UPDT_USR_ID
                ,T1.UPDT_DT
            )VALUES(
                 T2.TIMEZONE_ID
                ,T2.LANG_CD
                ,T2.TIMEZONE_TXT
                ,T2.REG_USR_ID
                ,T2.REG_DT
                ,T2.UPDT_USR_ID
                ,T2.UPDT_DT
            );
    </insert>

    <!--
                공통코드 업데이트
        DCS 공통코드 를 DB링크를 통하여 DMS 공통코드 를 등록/수정한다.
    -->
    <insert id="insertOrUpdateCommonCode">
        MERGE INTO CM_0301T T1
        USING (
            SELECT
                 CMM_GRP_CD
                ,CMM_GRP_CD_NM
                ,REMARK
                ,USE_YN
                ,REG_USR_ID
                ,REG_DT
                ,UPDT_USR_ID
                ,UPDT_DT
                ,REMARK_TITLE_NM
                ,SYS_CD_YN
            FROM CM_0301T@BHDMSOP
        ) T2 ON (
            T1.CMM_GRP_CD = T2.CMM_GRP_CD
        )
        WHEN MATCHED THEN
            UPDATE SET
                 T1.CMM_GRP_CD_NM   = T2.CMM_GRP_CD_NM
                ,T1.REMARK          = T2.REMARK
                ,T1.USE_YN          = T2.USE_YN
                ,T1.REG_USR_ID      = T2.REG_USR_ID
                ,T1.REG_DT          = T2.REG_DT
                ,T1.UPDT_USR_ID     = T2.UPDT_USR_ID
                ,T1.UPDT_DT         = T2.UPDT_DT
                ,T1.REMARK_TITLE_NM = T2.REMARK_TITLE_NM
                ,T1.SYS_CD_YN       = T2.SYS_CD_YN
        WHEN NOT MATCHED THEN
            INSERT(
                 T1.CMM_GRP_CD
                ,T1.CMM_GRP_CD_NM
                ,T1.REMARK
                ,T1.USE_YN
                ,T1.REG_USR_ID
                ,T1.REG_DT
                ,T1.UPDT_USR_ID
                ,T1.UPDT_DT
                ,T1.REMARK_TITLE_NM
                ,T1.SYS_CD_YN
            )VALUES(
                 T2.CMM_GRP_CD
                ,T2.CMM_GRP_CD_NM
                ,T2.REMARK
                ,T2.USE_YN
                ,T2.REG_USR_ID
                ,T2.REG_DT
                ,T2.UPDT_USR_ID
                ,T2.UPDT_DT
                ,T2.REMARK_TITLE_NM
                ,T2.SYS_CD_YN
            );

        MERGE INTO CM_0302T T1
        USING (
            SELECT
                 CMM_GRP_CD
                ,LANG_CD
                ,CMM_GRP_CD_TXT
                ,REG_USR_ID
                ,REG_DT
                ,UPDT_USR_ID
                ,UPDT_DT
                ,REMARK_TITLE_NM
            FROM CM_0302T@BHDMSOP
        ) T2 ON (
            T1.CMM_GRP_CD = T2.CMM_GRP_CD
            AND T1.LANG_CD = T2.LANG_CD
        )
        WHEN MATCHED THEN
            UPDATE SET
                 T1.CMM_GRP_CD_TXT  = T2.CMM_GRP_CD_TXT
                ,T1.REG_USR_ID      = T2.REG_USR_ID
                ,T1.REG_DT          = T2.REG_DT
                ,T1.UPDT_USR_ID     = T2.UPDT_USR_ID
                ,T1.UPDT_DT         = T2.UPDT_DT
                ,T1.REMARK_TITLE_NM = T2.REMARK_TITLE_NM
        WHEN NOT MATCHED THEN
            INSERT(
                 T1.CMM_GRP_CD
                ,T1.LANG_CD
                ,T1.CMM_GRP_CD_TXT
                ,T1.REG_USR_ID
                ,T1.REG_DT
                ,T1.UPDT_USR_ID
                ,T1.UPDT_DT
                ,T1.REMARK_TITLE_NM
            )VALUES(
                 T2.CMM_GRP_CD
                ,T2.LANG_CD
                ,T2.CMM_GRP_CD_TXT
                ,T2.REG_USR_ID
                ,T2.REG_DT
                ,T2.UPDT_USR_ID
                ,T2.UPDT_DT
                ,T2.REMARK_TITLE_NM
            );

        MERGE INTO CM_0303T T1
        USING (
            SELECT
                 CMM_CD
                ,CMM_GRP_CD
                ,CMM_CD_NM
                ,REMARK1
                ,REMARK2
                ,REMARK3
                ,REMARK4
                ,REMARK5
                ,REMARK6
                ,REMARK7
                ,REMARK8
                ,REMARK9
                ,REMARK10
                ,USE_YN
                ,SORT_ORDER
                ,REG_USR_ID
                ,REG_DT
                ,UPDT_USR_ID
                ,UPDT_DT
            FROM CM_0303T@BHDMSOP
        ) T2 ON (
            T1.CMM_CD = T2.CMM_CD
            AND T1.CMM_GRP_CD = T2.CMM_GRP_CD
        )
        WHEN MATCHED THEN
            UPDATE SET
                 T1.CMM_CD_NM   = T2.CMM_CD_NM
                ,T1.REMARK1     = T2.REMARK1
                ,T1.REMARK2     = T2.REMARK2
                ,T1.REMARK3     = T2.REMARK3
                ,T1.REMARK4     = T2.REMARK4
                ,T1.REMARK5     = T2.REMARK5
                ,T1.REMARK6     = T2.REMARK6
                ,T1.REMARK7     = T2.REMARK7
                ,T1.REMARK8     = T2.REMARK8
                ,T1.REMARK9     = T2.REMARK9
                ,T1.REMARK10    = T2.REMARK10
                ,T1.USE_YN      = T2.USE_YN
                ,T1.SORT_ORDER  = T2.SORT_ORDER
                ,T1.REG_USR_ID  = T2.REG_USR_ID
                ,T1.REG_DT      = T2.REG_DT
                ,T1.UPDT_USR_ID = T2.UPDT_USR_ID
                ,T1.UPDT_DT     = T2.UPDT_DT
        WHEN NOT MATCHED THEN
            INSERT(
                 T1.CMM_CD
                ,T1.CMM_GRP_CD
                ,T1.CMM_CD_NM
                ,T1.REMARK1
                ,T1.REMARK2
                ,T1.REMARK3
                ,T1.REMARK4
                ,T1.REMARK5
                ,T1.REMARK6
                ,T1.REMARK7
                ,T1.REMARK8
                ,T1.REMARK9
                ,T1.REMARK10
                ,T1.USE_YN
                ,T1.SORT_ORDER
                ,T1.REG_USR_ID
                ,T1.REG_DT
                ,T1.UPDT_USR_ID
                ,T1.UPDT_DT
            )VALUES(
                 T2.CMM_CD
                ,T2.CMM_GRP_CD
                ,T2.CMM_CD_NM
                ,T2.REMARK1
                ,T2.REMARK2
                ,T2.REMARK3
                ,T2.REMARK4
                ,T2.REMARK5
                ,T2.REMARK6
                ,T2.REMARK7
                ,T2.REMARK8
                ,T2.REMARK9
                ,T2.REMARK10
                ,T2.USE_YN
                ,T2.SORT_ORDER
                ,T2.REG_USR_ID
                ,T2.REG_DT
                ,T2.UPDT_USR_ID
                ,T2.UPDT_DT
            );

        MERGE INTO CM_0304T T1
        USING (
            SELECT
                 CMM_CD
                ,LANG_CD
                ,CMM_CD_TXT
                ,REG_USR_ID
                ,REG_DT
                ,UPDT_USR_ID
                ,UPDT_DT
                ,CMM_GRP_CD
            FROM CM_0304T@BHDMSOP
        ) T2 ON (
            T1.CMM_CD = T2.CMM_CD
            AND T1.LANG_CD = T2.LANG_CD
            AND T1.CMM_GRP_CD = T2.CMM_GRP_CD
        )
        WHEN MATCHED THEN
            UPDATE SET
                 T1.CMM_CD_TXT  = T2.CMM_CD_TXT
                ,T1.REG_USR_ID  = T2.REG_USR_ID
                ,T1.REG_DT      = T2.REG_DT
                ,T1.UPDT_USR_ID = T2.UPDT_USR_ID
                ,T1.UPDT_DT     = T2.UPDT_DT
        WHEN NOT MATCHED THEN
            INSERT(
                 T1.CMM_CD
                ,T1.LANG_CD
                ,T1.CMM_CD_TXT
                ,T1.REG_USR_ID
                ,T1.REG_DT
                ,T1.UPDT_USR_ID
                ,T1.UPDT_DT
                ,T1.CMM_GRP_CD
            )VALUES(
                 T2.CMM_CD
                ,T2.LANG_CD
                ,T2.CMM_CD_TXT
                ,T2.REG_USR_ID
                ,T2.REG_DT
                ,T2.UPDT_USR_ID
                ,T2.UPDT_DT
                ,T2.CMM_GRP_CD
            );
    </insert>

    <!--
                메세지소스 업데이트
        DCS 메세지소스 정보를 DB링크를 통하여 DMS 메세지소스 정보를 등록/수정한다.
    -->
    <insert id="insertOrUpdateMessageSource">
        MERGE INTO CM_0501T T1
        USING (
            SELECT
                 MESG_SEQ
                ,BUNDLE_NM
                ,LANG_CD
                ,CNTRY_CD
                ,MESG_KEY
                ,MESG_TXT
                ,LST_UPDT_DT
                ,REG_USR_ID
                ,REG_DT
                ,UPDT_USR_ID
                ,UPDT_DT
                ,USE_YN
            FROM CM_0501T@BHDMSOP
        ) T2 ON (
            T1.MESG_SEQ = T2.MESG_SEQ
        )
        WHEN MATCHED THEN
            UPDATE SET
                 T1.BUNDLE_NM   = T2.BUNDLE_NM
                ,T1.LANG_CD     = T2.LANG_CD
                ,T1.CNTRY_CD    = T2.CNTRY_CD
                ,T1.MESG_KEY    = T2.MESG_KEY
                ,T1.MESG_TXT    = T2.MESG_TXT
                ,T1.LST_UPDT_DT = T2.LST_UPDT_DT
                ,T1.REG_USR_ID  = T2.REG_USR_ID
                ,T1.REG_DT      = T2.REG_DT
                ,T1.UPDT_USR_ID = T2.UPDT_USR_ID
                ,T1.UPDT_DT     = T2.UPDT_DT
                ,T1.USE_YN      = T2.USE_YN
        WHEN NOT MATCHED THEN
            INSERT(
                 T1.MESG_SEQ
                ,T1.BUNDLE_NM
                ,T1.LANG_CD
                ,T1.CNTRY_CD
                ,T1.MESG_KEY
                ,T1.MESG_TXT
                ,T1.LST_UPDT_DT
                ,T1.REG_USR_ID
                ,T1.REG_DT
                ,T1.UPDT_USR_ID
                ,T1.UPDT_DT
                ,T1.USE_YN
            )VALUES(
                 T2.MESG_SEQ
                ,T2.BUNDLE_NM
                ,T2.LANG_CD
                ,T2.CNTRY_CD
                ,T2.MESG_KEY
                ,T2.MESG_TXT
                ,T2.LST_UPDT_DT
                ,T2.REG_USR_ID
                ,T2.REG_DT
                ,T2.UPDT_USR_ID
                ,T2.UPDT_DT
                ,T2.USE_YN
            );
    </insert>

    <!--
                메세지템플릿 업데이트
        DCS 메세지템플릿 정보를 DB링크를 통하여 DMS 메세지템플릿 정보를 등록/수정한다.
    -->
    <insert id="insertOrUpdateMessageTemplate">
        MERGE INTO CM_0601T T1
        USING (
            SELECT
                 MESG_TMPL_GRP_ID
                ,MESG_TMPL_GRP_NM
                ,USE_YN
                ,REG_USR_ID
                ,REG_DT
                ,UPDT_USR_ID
                ,UPDT_DT
                ,MESG_TMPL_GRP_TP
            FROM CM_0601T@BHDMSOP
        ) T2 ON (
            T1.MESG_TMPL_GRP_ID = T2.MESG_TMPL_GRP_ID
        )
        WHEN MATCHED THEN
            UPDATE SET
                 T1.MESG_TMPL_GRP_NM = T2.MESG_TMPL_GRP_NM
                ,T1.USE_YN           = T2.USE_YN
                ,T1.REG_USR_ID       = T2.REG_USR_ID
                ,T1.REG_DT           = T2.REG_DT
                ,T1.UPDT_USR_ID      = T2.UPDT_USR_ID
                ,T1.UPDT_DT          = T2.UPDT_DT
                ,T1.MESG_TMPL_GRP_TP = T2.MESG_TMPL_GRP_TP
        WHEN NOT MATCHED THEN
            INSERT(
                 T1.MESG_TMPL_GRP_ID
                ,T1.MESG_TMPL_GRP_NM
                ,T1.USE_YN
                ,T1.REG_USR_ID
                ,T1.REG_DT
                ,T1.UPDT_USR_ID
                ,T1.UPDT_DT
                ,T1.MESG_TMPL_GRP_TP
            )VALUES(
                 T2.MESG_TMPL_GRP_ID
                ,T2.MESG_TMPL_GRP_NM
                ,T2.USE_YN
                ,T2.REG_USR_ID
                ,T2.REG_DT
                ,T2.UPDT_USR_ID
                ,T2.UPDT_DT
                ,T2.MESG_TMPL_GRP_TP
            );

        MERGE INTO CM_0602T T1
        USING (
            SELECT
                 MESG_TMPL_NO
                ,MESG_TMPL_GRP_ID
                ,MESG_TMPL_TP
                ,MESG_TMPL_NM
                ,MESG_TMPL_CONT
                ,DEFAULT_YN
                ,USE_YN
                ,REG_USR_ID
                ,REG_DT
                ,UPDT_USR_ID
                ,UPDT_DT
            FROM CM_0602T@BHDMSOP
        ) T2 ON (
            T1.MESG_TMPL_NO = T2.MESG_TMPL_NO
        )
        WHEN MATCHED THEN
            UPDATE SET
                 T1.MESG_TMPL_GRP_ID = T2.MESG_TMPL_GRP_ID
                ,T1.MESG_TMPL_TP     = T2.MESG_TMPL_TP
                ,T1.MESG_TMPL_NM     = T2.MESG_TMPL_NM
                ,T1.MESG_TMPL_CONT   = T2.MESG_TMPL_CONT
                ,T1.DEFAULT_YN       = T2.DEFAULT_YN
                ,T1.USE_YN           = T2.USE_YN
                ,T1.REG_USR_ID       = T2.REG_USR_ID
                ,T1.REG_DT           = T2.REG_DT
                ,T1.UPDT_USR_ID      = T2.UPDT_USR_ID
                ,T1.UPDT_DT          = T2.UPDT_DT
        WHEN NOT MATCHED THEN
            INSERT(
                 T1.MESG_TMPL_NO
                ,T1.MESG_TMPL_GRP_ID
                ,T1.MESG_TMPL_TP
                ,T1.MESG_TMPL_NM
                ,T1.MESG_TMPL_CONT
                ,T1.DEFAULT_YN
                ,T1.USE_YN
                ,T1.REG_USR_ID
                ,T1.REG_DT
                ,T1.UPDT_USR_ID
                ,T1.UPDT_DT
            )VALUES(
                 T2.MESG_TMPL_NO
                ,T2.MESG_TMPL_GRP_ID
                ,T2.MESG_TMPL_TP
                ,T2.MESG_TMPL_NM
                ,T2.MESG_TMPL_CONT
                ,T2.DEFAULT_YN
                ,T2.USE_YN
                ,T2.REG_USR_ID
                ,T2.REG_DT
                ,T2.UPDT_USR_ID
                ,T2.UPDT_DT
            );
    </insert>

    <!--
                사용자정보 업데이트
        DCS 사용자정보 정보를 DB링크를 통하여 DMS 사용자정보 정보를 등록/수정한다.
    -->
    <insert id="insertOrUpdateUser" parameterType="string">
        MERGE INTO CM_0801T T1
        USING (
            SELECT
                 USR_ID
                ,USR_NM
                ,USR_PW
                ,ENABLED_YN
                ,LANG_CD
                ,EMP_NO
                ,DEL_YN
                ,THEME_ID
                ,REG_USR_ID
                ,REG_DT
                ,UPDT_USR_ID
                ,UPDT_DT
                ,CMPN_ID
                ,DLR_CD
                ,DEPT_CD
                ,PSTN_CD
                ,DUTY_CD
                ,EMAIL
                ,HP_NO
                ,TEL_NO1
                ,USR_PWD_CHG_DT
                ,USR_ID_NO
                ,JOIN_DT
                ,RETIRE_DT
                ,ZIP_NO
                ,ADDR1
                ,ADDR2
                ,ADDR3
                ,BIZ_CD
                ,SERV_YN
                ,SALE_YN
                ,CORP_CD
                ,TEL_NO2
                ,TSK_CD
            FROM CM_0801T@BHDMSOP
            WHERE DLR_CD = #{dlrCd}
        ) T2 ON (
            T1.USR_ID = T2.USR_ID
            AND T1.DLR_CD = T2.DLR_CD
        )
        WHEN MATCHED THEN
            UPDATE SET
                 T1.USR_NM         = T2.USR_NM
                ,T1.USR_PW         = T2.USR_PW
                ,T1.ENABLED_YN     = T2.ENABLED_YN
                ,T1.LANG_CD        = T2.LANG_CD
                ,T1.EMP_NO         = T2.EMP_NO
                ,T1.DEL_YN         = T2.DEL_YN
                ,T1.THEME_ID       = T2.THEME_ID
                ,T1.REG_USR_ID     = T2.REG_USR_ID
                ,T1.REG_DT         = T2.REG_DT
                ,T1.UPDT_USR_ID    = T2.UPDT_USR_ID
                ,T1.UPDT_DT        = T2.UPDT_DT
                ,T1.CMPN_ID        = T2.CMPN_ID
                ,T1.DEPT_CD        = T2.DEPT_CD
                ,T1.PSTN_CD        = T2.PSTN_CD
                ,T1.DUTY_CD        = T2.DUTY_CD
                ,T1.EMAIL          = T2.EMAIL
                ,T1.HP_NO          = T2.HP_NO
                ,T1.TEL_NO1        = T2.TEL_NO1
                ,T1.USR_PWD_CHG_DT = T2.USR_PWD_CHG_DT
                ,T1.USR_ID_NO      = T2.USR_ID_NO
                ,T1.JOIN_DT        = T2.JOIN_DT
                ,T1.RETIRE_DT      = T2.RETIRE_DT
                ,T1.ZIP_NO         = T2.ZIP_NO
                ,T1.ADDR1          = T2.ADDR1
                ,T1.ADDR2          = T2.ADDR2
                ,T1.ADDR3          = T2.ADDR3
                ,T1.BIZ_CD         = T2.BIZ_CD
                ,T1.SERV_YN        = T2.SERV_YN
                ,T1.SALE_YN        = T2.SALE_YN
                ,T1.CORP_CD        = T2.CORP_CD
                ,T1.TEL_NO2        = T2.TEL_NO2
                ,T1.TSK_CD         = T2.TSK_CD
        WHEN NOT MATCHED THEN
            INSERT(
                 T1.USR_ID
                ,T1.USR_NM
                ,T1.USR_PW
                ,T1.ENABLED_YN
                ,T1.LANG_CD
                ,T1.EMP_NO
                ,T1.DEL_YN
                ,T1.THEME_ID
                ,T1.REG_USR_ID
                ,T1.REG_DT
                ,T1.UPDT_USR_ID
                ,T1.UPDT_DT
                ,T1.CMPN_ID
                ,T1.DLR_CD
                ,T1.DEPT_CD
                ,T1.PSTN_CD
                ,T1.DUTY_CD
                ,T1.EMAIL
                ,T1.HP_NO
                ,T1.TEL_NO1
                ,T1.USR_PWD_CHG_DT
                ,T1.USR_ID_NO
                ,T1.JOIN_DT
                ,T1.RETIRE_DT
                ,T1.ZIP_NO
                ,T1.ADDR1
                ,T1.ADDR2
                ,T1.ADDR3
                ,T1.BIZ_CD
                ,T1.SERV_YN
                ,T1.SALE_YN
                ,T1.CORP_CD
                ,T1.TEL_NO2
                ,T1.TSK_CD
            )VALUES(
                 T2.USR_ID
                ,T2.USR_NM
                ,T2.USR_PW
                ,T2.ENABLED_YN
                ,T2.LANG_CD
                ,T2.EMP_NO
                ,T2.DEL_YN
                ,T2.THEME_ID
                ,T2.REG_USR_ID
                ,T2.REG_DT
                ,T2.UPDT_USR_ID
                ,T2.UPDT_DT
                ,T2.CMPN_ID
                ,T2.DLR_CD
                ,T2.DEPT_CD
                ,T2.PSTN_CD
                ,T2.DUTY_CD
                ,T2.EMAIL
                ,T2.HP_NO
                ,T2.TEL_NO1
                ,T2.USR_PWD_CHG_DT
                ,T2.USR_ID_NO
                ,T2.JOIN_DT
                ,T2.RETIRE_DT
                ,T2.ZIP_NO
                ,T2.ADDR1
                ,T2.ADDR2
                ,T2.ADDR3
                ,T2.BIZ_CD
                ,T2.SERV_YN
                ,T2.SALE_YN
                ,T2.CORP_CD
                ,T2.TEL_NO2
                ,T2.TSK_CD
            );
    </insert>

    <insert id="insertOrUpdateAuthority">
        MERGE INTO CM_0804T T1
        USING (
            SELECT
                 ROLE_ID
                ,ROLE_NM
                ,ROLE_DETL_CONT
                ,REG_USR_ID
                ,REG_DT
                ,UPDT_USR_ID
                ,UPDT_DT
                ,SYS_CD
                ,ROLE_TP
                ,USE_YN
            FROM CM_0804T@BHDMSOP
            WHERE SYS_CD = 'D'
        ) T2 ON (
            T1.ROLE_ID = T2.ROLE_ID
        )
        WHEN MATCHED THEN
            UPDATE SET
                 T1.ROLE_NM        = T2.ROLE_NM
                ,T1.ROLE_DETL_CONT = T2.ROLE_DETL_CONT
                ,T1.REG_USR_ID     = T2.REG_USR_ID
                ,T1.REG_DT         = T2.REG_DT
                ,T1.UPDT_USR_ID    = T2.UPDT_USR_ID
                ,T1.UPDT_DT        = T2.UPDT_DT
                ,T1.SYS_CD         = T2.SYS_CD
                ,T1.ROLE_TP        = T2.ROLE_TP
                ,T1.USE_YN         = T2.USE_YN
        WHEN NOT MATCHED THEN
            INSERT(
                 T1.ROLE_ID
                ,T1.ROLE_NM
                ,T1.ROLE_DETL_CONT
                ,T1.REG_USR_ID
                ,T1.REG_DT
                ,T1.UPDT_USR_ID
                ,T1.UPDT_DT
                ,T1.SYS_CD
                ,T1.ROLE_TP
                ,T1.USE_YN
            )VALUES(
                 T2.ROLE_ID
                ,T2.ROLE_NM
                ,T2.ROLE_DETL_CONT
                ,T2.REG_USR_ID
                ,T2.REG_DT
                ,T2.UPDT_USR_ID
                ,T2.UPDT_DT
                ,T2.SYS_CD
                ,T2.ROLE_TP
                ,T2.USE_YN
            );

        MERGE INTO CM_0803T T1
        USING (
            SELECT
                 ROLE_ID
                ,REF_ID
                ,REF_TP
                ,REG_USR_ID
                ,REG_DT
                ,UPDT_USR_ID
                ,UPDT_DT
                ,SYS_CD
                ,USE_YN
            FROM CM_0803T@BHDMSOP
            WHERE SYS_CD = 'D'
        ) T2 ON (
            T1.ROLE_ID = T2.ROLE_ID
            AND T1.REF_ID = T2.REF_ID
            AND T1.REF_TP = T2.REF_TP
        )
        WHEN MATCHED THEN
            UPDATE SET
                 T1.REG_USR_ID  = T2.REG_USR_ID
                ,T1.REG_DT      = T2.REG_DT
                ,T1.UPDT_USR_ID = T2.UPDT_USR_ID
                ,T1.UPDT_DT     = T2.UPDT_DT
                ,T1.SYS_CD      = T2.SYS_CD
                ,T1.USE_YN      = T2.USE_YN
        WHEN NOT MATCHED THEN
            INSERT(
                 T1.ROLE_ID
                ,T1.REF_ID
                ,T1.REF_TP
                ,T1.REG_USR_ID
                ,T1.REG_DT
                ,T1.UPDT_USR_ID
                ,T1.UPDT_DT
                ,T1.SYS_CD
                ,T1.USE_YN
            )VALUES(
                 T2.ROLE_ID
                ,T2.REF_ID
                ,T2.REF_TP
                ,T2.REG_USR_ID
                ,T2.REG_DT
                ,T2.UPDT_USR_ID
                ,T2.UPDT_DT
                ,T2.SYS_CD
                ,T2.USE_YN
            );

        MERGE INTO CM_0805T T1
        USING (
            SELECT
                 PARENT_ROLE_ID
                ,CHILD_ROLE_ID
                ,REG_USR_ID
                ,REG_DT
                ,UPDT_USR_ID
                ,UPDT_DT
                ,SYS_CD
                ,USE_YN
            FROM CM_0805T@BHDMSOP
            WHERE SYS_CD = 'D'
        ) T2 ON (
            T1.PARENT_ROLE_ID = T2.PARENT_ROLE_ID
            AND T1.CHILD_ROLE_ID = T2.CHILD_ROLE_ID
        )
        WHEN MATCHED THEN
            UPDATE SET
                 T1.REG_USR_ID     = T2.REG_USR_ID
                ,T1.REG_DT         = T2.REG_DT
                ,T1.UPDT_USR_ID    = T2.UPDT_USR_ID
                ,T1.UPDT_DT        = T2.UPDT_DT
                ,T1.SYS_CD         = T2.SYS_CD
                ,T1.USE_YN         = T2.USE_YN
        WHEN NOT MATCHED THEN
            INSERT(
                 T1.PARENT_ROLE_ID
                ,T1.CHILD_ROLE_ID
                ,T1.REG_USR_ID
                ,T1.REG_DT
                ,T1.UPDT_USR_ID
                ,T1.UPDT_DT
                ,T1.SYS_CD
                ,T1.USE_YN
            )VALUES(
                 T2.PARENT_ROLE_ID
                ,T2.CHILD_ROLE_ID
                ,T2.REG_USR_ID
                ,T2.REG_DT
                ,T2.UPDT_USR_ID
                ,T2.UPDT_DT
                ,T2.SYS_CD
                ,T2.USE_YN
            );

        MERGE INTO CM_0809T T1
        USING (
            SELECT
                 VIEW_ID
                ,VIEW_NM
                ,VIEW_INFO_CONT
                ,VIEW_URL
                ,VIEW_TP
                ,MESG_KEY
                ,SORT_ORDER
                ,DISPLAY_YN
                ,T_CD
                ,ICON_NM
                ,REG_USR_ID
                ,REG_DT
                ,UPDT_USR_ID
                ,UPDT_DT
                ,WEB_MOBILE_DSTIN_CD
                ,SYS_CD
                ,USE_YN
            FROM CM_0809T@BHDMSOP
            WHERE SYS_CD = 'D'
        ) T2 ON (
            T1.VIEW_ID = T2.VIEW_ID
        )
        WHEN MATCHED THEN
            UPDATE SET
                 T1.VIEW_NM             = T2.VIEW_NM
                ,T1.VIEW_INFO_CONT      = T2.VIEW_INFO_CONT
                ,T1.VIEW_URL            = T2.VIEW_URL
                ,T1.VIEW_TP             = T2.VIEW_TP
                ,T1.MESG_KEY            = T2.MESG_KEY
                ,T1.SORT_ORDER          = T2.SORT_ORDER
                ,T1.DISPLAY_YN          = T2.DISPLAY_YN
                ,T1.T_CD                = T2.T_CD
                ,T1.ICON_NM             = T2.ICON_NM
                ,T1.REG_USR_ID          = T2.REG_USR_ID
                ,T1.REG_DT              = T2.REG_DT
                ,T1.UPDT_USR_ID         = T2.UPDT_USR_ID
                ,T1.UPDT_DT             = T2.UPDT_DT
                ,T1.WEB_MOBILE_DSTIN_CD = T2.WEB_MOBILE_DSTIN_CD
                ,T1.SYS_CD              = T2.SYS_CD
                ,T1.USE_YN              = T2.USE_YN
        WHEN NOT MATCHED THEN
            INSERT(
                 T1.VIEW_ID
                ,T1.VIEW_NM
                ,T1.VIEW_INFO_CONT
                ,T1.VIEW_URL
                ,T1.VIEW_TP
                ,T1.MESG_KEY
                ,T1.SORT_ORDER
                ,T1.DISPLAY_YN
                ,T1.T_CD
                ,T1.ICON_NM
                ,T1.REG_USR_ID
                ,T1.REG_DT
                ,T1.UPDT_USR_ID
                ,T1.UPDT_DT
                ,T1.WEB_MOBILE_DSTIN_CD
                ,T1.SYS_CD
                ,T1.USE_YN
            )VALUES(
                 T2.VIEW_ID
                ,T2.VIEW_NM
                ,T2.VIEW_INFO_CONT
                ,T2.VIEW_URL
                ,T2.VIEW_TP
                ,T2.MESG_KEY
                ,T2.SORT_ORDER
                ,T2.DISPLAY_YN
                ,T2.T_CD
                ,T2.ICON_NM
                ,T2.REG_USR_ID
                ,T2.REG_DT
                ,T2.UPDT_USR_ID
                ,T2.UPDT_DT
                ,T2.WEB_MOBILE_DSTIN_CD
                ,T2.SYS_CD
                ,T2.USE_YN
            );

        MERGE INTO CM_0810T T1
        USING (
            SELECT
                 VIEW_ID
                ,REF_ID
                ,REF_TP
                ,MASK
                ,PERMISSIONS
                ,REG_USR_ID
                ,REG_DT
                ,UPDT_USR_ID
                ,UPDT_DT
                ,SYS_CD
                ,USE_YN
            FROM CM_0810T@BHDMSOP
            WHERE SYS_CD = 'D'
        ) T2 ON (
            T1.VIEW_ID = T2.VIEW_ID
            AND T1.REF_ID = T2.REF_ID
            AND T1.REF_TP = T2.REF_TP
        )
        WHEN MATCHED THEN
            UPDATE SET
                 T1.MASK        = T2.MASK
                ,T1.PERMISSIONS = T2.PERMISSIONS
                ,T1.REG_USR_ID  = T2.REG_USR_ID
                ,T1.REG_DT      = T2.REG_DT
                ,T1.UPDT_USR_ID = T2.UPDT_USR_ID
                ,T1.UPDT_DT     = T2.UPDT_DT
                ,T1.SYS_CD      = T2.SYS_CD
                ,T1.USE_YN      = T2.USE_YN
        WHEN NOT MATCHED THEN
            INSERT(
                 T1.VIEW_ID
                ,T1.REF_ID
                ,T1.REF_TP
                ,T1.MASK
                ,T1.PERMISSIONS
                ,T1.REG_USR_ID
                ,T1.REG_DT
                ,T1.UPDT_USR_ID
                ,T1.UPDT_DT
                ,T1.SYS_CD
                ,T1.USE_YN
            )VALUES(
                 T2.VIEW_ID
                ,T2.REF_ID
                ,T2.REF_TP
                ,T2.MASK
                ,T2.PERMISSIONS
                ,T2.REG_USR_ID
                ,T2.REG_DT
                ,T2.UPDT_USR_ID
                ,T2.UPDT_DT
                ,T2.SYS_CD
                ,T2.USE_YN
            );

        MERGE INTO CM_0808T T1
        USING (
            SELECT
                 PARENT_VIEW_ID
                ,CHILD_VIEW_ID
                ,REG_USR_ID
                ,REG_DT
                ,UPDT_USR_ID
                ,UPDT_DT
                ,SYS_CD
            FROM CM_0808T@BHDMSOP
            WHERE SYS_CD = 'D'
        ) T2 ON (
            T1.PARENT_VIEW_ID = T2.PARENT_VIEW_ID
            AND T1.CHILD_VIEW_ID = T2.CHILD_VIEW_ID
        )
        WHEN MATCHED THEN
            UPDATE SET
                T1.REG_USR_ID     = T2.REG_USR_ID
                ,T1.REG_DT         = T2.REG_DT
                ,T1.UPDT_USR_ID    = T2.UPDT_USR_ID
                ,T1.UPDT_DT        = T2.UPDT_DT
                ,T1.SYS_CD         = T2.SYS_CD
        WHEN NOT MATCHED THEN
            INSERT(
                 T1.PARENT_VIEW_ID
                ,T1.CHILD_VIEW_ID
                ,T1.REG_USR_ID
                ,T1.REG_DT
                ,T1.UPDT_USR_ID
                ,T1.UPDT_DT
                ,T1.SYS_CD
            )VALUES(
                 T2.PARENT_VIEW_ID
                ,T2.CHILD_VIEW_ID
                ,T2.REG_USR_ID
                ,T2.REG_DT
                ,T2.UPDT_USR_ID
                ,T2.UPDT_DT
                ,T2.SYS_CD
            );
    </insert>

    <!--
                사업부 업데이트
        DCS 사업부정보를 DB링크를 통하여 DMS 사업부 정보를 등록/수정한다.
    -->
    <insert id="insertOrUpdateDivision">
        MERGE INTO CM_2501T T1
        USING (
            SELECT
                DIVI_CD
                ,DIVI_NM
            FROM CM_2501T@BHDMSOP
        ) T2 ON (
            T1.DIVI_CD = T2.DIVI_CD
        )
        WHEN MATCHED THEN
            UPDATE SET
                 T1.DIVI_NM = T2.DIVI_NM
        WHEN NOT MATCHED THEN
            INSERT(
                 T1.DIVI_CD
                ,T1.DIVI_NM
            )VALUES(
                 T2.DIVI_CD
                ,T2.DIVI_NM
            );
    </insert>

    <!--
                사무소 업데이트
        DCS 사무소 정보를 DB링크를 통하여 DMS 사무소 정보를 등록/수정한다.
    -->
    <insert id="insertOrUpdateOffice">
        MERGE INTO CM_2601T T1
        USING (
            SELECT
                 DIVI_CD
                ,OFF_CD
                ,OFF_NM
            FROM CM_2601T@BHDMSOP
        ) T2 ON (
            T1.OFF_CD = T2.OFF_CD
        )
        WHEN MATCHED THEN
            UPDATE SET
                 T1.DIVI_CD = T2.DIVI_CD
                ,T1.OFF_NM  = T2.OFF_NM
        WHEN NOT MATCHED THEN
            INSERT(
                 T1.DIVI_CD
                ,T1.OFF_CD
                ,T1.OFF_NM
            )VALUES(
                 T2.DIVI_CD
                ,T2.OFF_CD
                ,T2.OFF_NM
            );
    </insert>

    <!--
                성정보 업데이트
        DCS 성정보를 DB링크를 통하여 DMS 성정보를 등록/수정한다.
    -->
    <insert id="insertOrUpdateCastle">
        MERGE INTO CM_2701T T1
        USING (
            SELECT
                 CSTL_CD
                ,CSTL_NM
                ,OFF_CD
            FROM CM_2701T@BHDMSOP
        ) T2 ON (
            T1.CSTL_CD = T2.CSTL_CD
        )
        WHEN MATCHED THEN
            UPDATE SET
                 T1.CSTL_NM =  T2.CSTL_NM
                ,T1.OFF_CD  =  T2.OFF_CD
        WHEN NOT MATCHED THEN
            INSERT(
                 T1.CSTL_CD
                ,T1.CSTL_NM
                ,T1.OFF_CD
            )VALUES(
                 T2.CSTL_CD
                ,T2.CSTL_NM
                ,T2.OFF_CD
            );
    </insert>

    <!--
                도시정보 업데이트
        DCS 도시정보를 DB링크를 통하여 DMS 도시정보를 등록/수정한다.
    -->
    <insert id="insertOrUpdateCity">
        MERGE INTO CM_3201T T1
        USING (
            SELECT
                 CSTL_CD
                ,CITY_CD
                ,CITY_NM
            FROM CM_3201T@BHDMSOP
        ) T2 ON (
            T1.CITY_CD = T2.CITY_CD
        )
        WHEN MATCHED THEN
            UPDATE SET
                 T1.CSTL_CD = T2.CSTL_CD
                ,T1.CITY_NM = T2.CITY_NM
        WHEN NOT MATCHED THEN
            INSERT(
                 T1.CSTL_CD
                ,T1.CITY_CD
                ,T1.CITY_NM
            )VALUES(
                 T2.CSTL_CD
                ,T2.CITY_CD
                ,T2.CITY_NM
            );
    </insert>

    <!--
                직무정보 업데이트
        DCS 직무정보를 DB링크를 통하여 DMS 직무정보를 등록/수정한다.
    -->
    <insert id="insertOrUpdateTask">
        MERGE INTO CM_2801T T1
        USING (
            SELECT
                 CMP_TP
                ,TSK_CD
                ,TSK_NM
                ,DEPT_CD
            FROM CM_2801T@BHDMSOP
            WHERE CMP_TP = '10'
        ) T2 ON (
            T1.CMP_TP = T2.CMP_TP
            AND T1.TSK_CD = T2.TSK_CD
        )
        WHEN MATCHED THEN
            UPDATE SET
                 T1.TSK_NM  = T2.TSK_NM
                ,T1.DEPT_CD = T2.DEPT_CD
        WHEN NOT MATCHED THEN
            INSERT(
                 T1.CMP_TP
                ,T1.TSK_CD
                ,T1.TSK_NM
                ,T1.DEPT_CD
            )VALUES(
                 T2.CMP_TP
                ,T2.TSK_CD
                ,T2.TSK_NM
                ,T2.DEPT_CD
            );
    </insert>

    <!--
                부서정보 업데이트
        DCS 부서정보를 DB링크를 통하여 DMS 부서정보를 등록/수정한다.
    -->
    <insert id="insertOrUpdateDepartment">
        MERGE INTO CM_3401T T1
        USING (
            SELECT
                 CMP_TP
                ,DEPT_CD
                ,DEPT_NM
                ,USE_YN
            FROM CM_3401T@BHDMSOP
            WHERE CMP_TP = '10'
        ) T2 ON (
            T1.CMP_TP = T2.CMP_TP
            AND T1.DEPT_CD = T2.DEPT_CD
        )
        WHEN MATCHED THEN
            UPDATE SET
                 T1.DEPT_NM = T2.DEPT_NM
                ,T1.USE_YN  = T2.USE_YN
        WHEN NOT MATCHED THEN
            INSERT(
                 T1.CMP_TP
                ,T1.DEPT_CD
                ,T1.DEPT_NM
                ,T1.USE_YN
            )VALUES(
                 T2.CMP_TP
                ,T2.DEPT_CD
                ,T2.DEPT_NM
                ,T2.USE_YN
            );
    </insert>

    <!--
                기초정보 데이터를 일괄 적용 프로시저 호출
        DCS 기초정보를 DB링크를 통하여 DMS 기초정보를 등록/수정한다.
    -->
    <insert id="updateMigNdmsComInit" parameterType="MigVO" statementType="CALLABLE">
        {call DMSDB.MIG_NDMS_COM_INIT(
            #{dlrCd, mode=IN, jdbcType=VARCHAR}
            ,#{useCenterDmsYn, mode=IN, jdbcType=VARCHAR}
            ,#{partRunNum, mode=IN, jdbcType=NUMERIC}
            ,#{membershipPolicy, mode=IN, jdbcType=VARCHAR}
         )}
    </insert>

	<!--
                마이그레이션 프로시저 호출
        DCS DB에서 마이그레이션 작업을 수행한다.
    -->
    <insert id="updateMigProcMain" parameterType="string" statementType="CALLABLE">
        {call MIG.MIG_PROC_MAIN@BHDMSOP(
            #{value, mode=IN, jdbcType=VARCHAR}
         )}
    </insert>

    <!--
                마이그레이션 프로시저 실행 로그 조회
    -->
    <select id="selectMigProcLogList" parameterType="map" resultType="MigProcLogVO">
        SELECT * FROM (
            SELECT *
            FROM MIG.MIG_PROC_LOG_TBL@BHDMSOP
            WHERE TGT_DLR_CD = #{dlrCd, jdbcType=VARCHAR}
            ORDER BY START_DATE ASC
        ) T1
        WHERE ROWNUM > #{skipRows, jdbcType=NUMERIC}
    </select>

    <!--
                마이그레이션 프로시저 호출
        DCS DB에서 수행된 마이그레이션 데이터를 신규 딜러로 이관한다.
    -->
    <insert id="updateMigNdmsInsert" parameterType="MigVO" statementType="CALLABLE">
        {call DMSDB.MIG_NDMS_INSERT(
            #{dlrCd, mode=IN, jdbcType=VARCHAR}
           ,#{partRunNum, mode=IN, jdbcType=NUMERIC}
         )}
    </insert>


    <!--
        마이그레이션 데이터를 신규 딜러로 이관 실행 로그 조회
    -->
    <select id="selectMigPrgStat" parameterType="string" resultType="string">
        SELECT MIG_PRG_STAT
        FROM DMSDB.CM_0101T@BHDMSOP
        WHERE DLR_CD = #{value}
    </select>

    <!--
                마이그레이션 후행 프로시저 호출
        DCS DB에서 수행된 마이그레이션 데이터를 보정한다.
    -->
    <insert id="updateMigAfeterProcInsert" parameterType="MigVO" statementType="CALLABLE">
        {call MIG_DMS_DCS_COM(
            #{dlrCd, mode=IN, jdbcType=VARCHAR}
           ,#{partRunNum, mode=IN, jdbcType=NUMERIC}
         )}
    </insert>

    <!--
                마이그레이션 후행 프로시저 호출(DCS->DMS)
        DCS DB에서 수행된 마이그레이션 데이터를 전송한다.
    -->
    <insert id="updateMigDcsDmsProcInsert" parameterType="MigVO" statementType="CALLABLE">
        {call MIG_CRM_UPLOAD(
            #{dlrCd, mode=IN, jdbcType=VARCHAR}
           ,#{partRunNum, mode=IN, jdbcType=NUMERIC}
         )}
    </insert>

    <!--
       마이그레이션 대상 Job List 조회
    -->
    <select id="selectMigTargetList" parameterType="MigTgtInfoVO" resultType="MigTgtInfoVO">
        SELECT '1' AS RNUM
              ,'1' AS PART_RUN_NUM
              ,'updateMigNdmsComInit' AS PID
              ,'Master Data Init' AS PNM
              ,CASE WHEN (SELECT COUNT(1) FROM MIG_NDMS_COM_INIT_LOG_TBL WHERE PID BETWEEN 1 AND 99) = 0 THEN '1'
                    WHEN (SELECT COUNT(1) FROM MIG_NDMS_COM_INIT_LOG_TBL WHERE PNM = 'MIG_NDMS_COM_INIT FINISH') > 0 THEN '3'
                    ELSE '2' END AS PSTEP
              ,'' AS PREPID
              ,'Y' AS CAN_YN
        FROM DUAL
        UNION ALL
        SELECT '2' AS RNUM
              ,'100' AS PART_RUN_NUM
              ,'updateMigNdmsInsert' AS PID
              ,'Migration Data Init' AS PNM
              ,CASE WHEN (SELECT COUNT(1) FROM MIG_NDMS_COM_INIT_LOG_TBL WHERE PID BETWEEN 100 AND 199) = 0 THEN '1'
                    WHEN (SELECT COUNT(1) FROM MIG_NDMS_COM_INIT_LOG_TBL WHERE PNM = 'MIG_NDMS_INSERT FINISH') > 0 THEN '3'
                    ELSE '2' END AS PSTEP
              ,'' AS PREPID
              ,NVL((SELECT CASE WHEN MIG_PRG_STAT = 'Z' THEN 'Y' ELSE 'N' END AS CAN_YN FROM CM_0101T@BHDCSOP WHERE DLR_CD = #{dlrCd}),'N') AS CAN_YN
        FROM DUAL
        UNION ALL
        SELECT '3' AS RNUM
              ,'200' AS PART_RUN_NUM
              ,'updateMigAfeterProcInsert' AS PID
              ,'Migration After Job' AS PNM
              ,CASE WHEN (SELECT COUNT(1) FROM MIG_NDMS_COM_INIT_LOG_TBL WHERE PID BETWEEN 200 AND 299) = 0 THEN '1'
                    WHEN (SELECT COUNT(1) FROM MIG_NDMS_COM_INIT_LOG_TBL WHERE PNM = 'MIG_DMS_DCS_COM FINISH') > 0 THEN '3'
                    ELSE '2' END AS PSTEP
              ,'' AS PREPID
              ,(SELECT CASE WHEN NVL(COUNT(1),0) > 0 THEN 'Y' ELSE 'N' END AS CAN_YN FROM MIG_NDMS_COM_INIT_LOG_TBL WHERE PNM = 'MIG_NDMS_INSERT FINISH') AS CAN_YN
        FROM DUAL
        UNION ALL
        SELECT '4' AS RNUM
              ,'300' AS PART_RUN_NUM
              ,'updateMigDcsDmsProcInsert' AS PID
              ,'Migration DcsDms Job' AS PNM
              ,CASE WHEN (SELECT COUNT(1) FROM MIG_NDMS_COM_INIT_LOG_TBL WHERE PID BETWEEN 300 AND 399) = 0 THEN '1'
                    WHEN (SELECT COUNT(1) FROM MIG_NDMS_COM_INIT_LOG_TBL WHERE PNM = 'MIG_CRM_UPLOAD END') > 0 THEN '3'
                    ELSE '2' END AS PSTEP
              ,'' AS PREPID
              ,(SELECT CASE WHEN NVL(COUNT(1),0) > 0 THEN 'Y' ELSE 'N' END AS CAN_YN FROM MIG_NDMS_COM_INIT_LOG_TBL WHERE PNM = 'MIG_DMS_DCS_COM FINISH') AS CAN_YN
        FROM DUAL
    </select>

    <!--
        마이그레이션 데이터를 신규 딜러로 이관 실행 로그 조회
    -->
    <select id="selectMigNdmsLogList" parameterType="int" resultType="MigNdmsComInitLogVO">
            SELECT
                V1.*
                ,NVL(TO_CHAR((SELECT BYTES/1024/1024 FROM USER_SEGMENTS WHERE V1.PNM = SEGMENT_NAME)),'N/A') as BYTES
                ,ROWNUM RNUM
            FROM MIG_NDMS_COM_INIT_LOG_TBL V1
            WHERE 1=1
                <choose>
                    <when test='value == 1'>
                        AND V1.SEQ_NO <![CDATA[<]]> 100
                    </when>
                    <when test='value == 2'>
                        AND V1.SEQ_NO BETWEEN 100 AND 199
                    </when>
                    <when test='value == 3'>
                        AND V1.SEQ_NO BETWEEN 200 AND 299
                    </when>
                    <when test='value == 4'>
                        AND V1.SEQ_NO BETWEEN 300 AND 399
                    </when>
                </choose>
            ORDER BY V1.SEQ_NO DESC
    </select>

    <!-- 마이그레이션 체크 목록 조회 -->
    <select id="selectMigCheckList" parameterType="MigCheckSearchVO" resultType="MigCheckVO">
        SELECT SEQ
              ,DLR_CD
              ,CHK_NM
              ,(SELECT CMM_CD_TXT
                  FROM CM_0304T
                 WHERE CMM_GRP_CD ='COM067'
                   AND CHK_TP = CMM_CD
                   AND LANG_CD = 'zh') AS CHK_TP
              ,TBL_NM
              ,COL_NM
              ,(SELECT CMM_CD_TXT
                  FROM CM_0304T
                 WHERE CMM_GRP_CD ='COM068'
                   AND CHK_RSLT_TP = CMM_CD
                   AND LANG_CD = 'zh') AS CHK_RSLT_TP
              ,(SELECT CMM_CD_TXT
                  FROM CM_0304T
                 WHERE CMM_GRP_CD ='COM069'
                   AND ERR_CD = CMM_CD
                   AND LANG_CD = 'zh') AS ERR_CD
              ,MSG
              ,CNT
              ,REG_USR_ID
              ,REG_DT
              ,UPDT_USR_ID
              ,UPDT_DT
          FROM CM_3901T
         WHERE 1 = 1
        <if test='sDlrCd != null and sDlrCd != ""'>
           AND DLR_CD = #{sDlrCd}
        </if>
        <if test='sChkNm != null and sChkNm != ""'>
           AND CHK_NM LIKE '%'||#{sChkNm}||'%'
        </if>
        <if test='sChkTp != null and sChkTp != ""'>
           AND CHK_TP = #{sChkTp}
        </if>
        <if test='sChkRsltTp != null and sChkRsltTp != ""'>
           AND CHK_RSLT_TP = #{sChkRsltTp}
        </if>
        <if test='sErrCd != null and sErrCd != ""'>
           AND ERR_CD = #{sErrCd}
        </if>
         ORDER BY SEQ
    </select>

    <!--
                마이그레이션 검증 실행
    -->
    <insert id="multiMigCheckInfo" parameterType="MigVO" statementType="CALLABLE">
        {call MIG_CHK_LOG(
            #{dlrCd, mode=IN, jdbcType=VARCHAR}
         )}
    </insert>
</mapper>